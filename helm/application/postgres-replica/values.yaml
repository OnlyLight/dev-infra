postgresql:
  storage:
    size: 1Gi

  replica:
    name: postgres-replica
    image: postgres:14
    service:
      name: postgres-replica-headless
      port: 5432
    resources:
      requests:
        memory: "128Mi"
        cpu: "100m"
    env:
      POSTGRES_MASTER_USER: crawler
      POSTGRES_MASTER_PASSWORD: asdasd123
    config:

      pg_hba_conf: |
        # Unix
        local   all             all                                     trust
        # IPv4 local connections:
        host    all             all             127.0.0.1/32            trust
        # IPv6 local connections:
        host    all             all             ::1/128                 trust
        local   replication     all                                     trust
        host    replication     all             127.0.0.1/32            trust
        host    replication     all             ::1/128                 trust
        host    replication     all             0.0.0.0/0               trust
        host    all             all             all                     md5

      postgresql_conf: |
        listen_addresses = '*'
        max_connections = 100
        port = 5432
        shared_buffers = 128MB
        dynamic_shared_memory_type = posix

        max_wal_size = 1GB
        min_wal_size = 80MB
        log_timezone = 'Etc/UTC'
        datestyle = 'iso, mdy'
        timezone = 'Etc/UTC'
        lc_messages = 'en_US.utf8'
        lc_monetary = 'en_US.utf8'
        lc_numeric = 'en_US.utf8'
        lc_time = 'en_US.utf8'
        default_text_search_config = 'pg_catalog.english'
        
        # Options
        hot_standby = on
        wal_level = replica
        max_wal_senders = 2
        max_replication_slots = 2
        synchronous_commit = off
